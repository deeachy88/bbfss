{% load static %}
<div class="accordion" role="tablist">
    {% for application_details in application_details %}
        <div class="card">
            <div class="card-header" role="tab" id="headingOne">
                <a data-toggle="collapse" href="#collapseOne" aria-expanded="false" aria-controls="collapseOne" class="collapsed">
                    Application Details
                </a>
            </div>

            <div id="collapseOne" class="collapse" role="tabpanel" aria-labelledby="headingOne" data-parent="#accordion" style="">
                <div class="card-body">
                        {% if application_details.Import_Type == 'P' %}
                                <div class="row justify-content-center">
                                    <div class="form-check text-center">
                                        <label>Import Type <font color="red">*</font></label><br>
                                        <label class="form-radio-label">
                                            <input class="form-radio-input" type="radio" name="importType" checked>
                                            <span class="form-radio-sign">Plant And Plant Products</span>
                                        </label>
                                        <label class="form-radio-label ml-3">
                                            <input class="form-radio-input" type="radio" name="importType" disabled>
                                            <span class="form-radio-sign">Agrochemicals</span>
                                        </label>
                                    </div>
                                </div>
                            {% else %}
                                <div class="row justify-content-center">
                                    <div class="form-check text-center">
                                        <label>Import Type <font color="red">*</font></label><br>
                                        <label class="form-radio-label">
                                            <input class="form-radio-input" type="radio" name="importType" disabled>
                                            <span class="form-radio-sign">Plant And Plant Products</span>
                                        </label>
                                        <label class="form-radio-label ml-3">
                                            <input class="form-radio-input" type="radio" name="importType" checked>
                                            <span class="form-radio-sign">Agrochemicals</span>
                                        </label>
                                    </div>
                                </div>
                            {% endif %}
                            {% if application_details.Application_Type == 'Personal' %}
                                <br>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <label class="form-label">Application Type <font color="red">*</font></label>
                                    </div>
                                    <div class="col-sm-8 justify-content-center">
                                        <label class="custom-control custom-radio">
                                            <input type="radio" name="Application_Type" class="custom-control-input" checked>
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description">Personal</span>
                                        </label>
                                        <label class="custom-control custom-radio">
                                            <input type="radio" name="Application_Type" class="custom-control-input" disabled>
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description">Commercial</span>
                                        </label>
                                    </div>
                                </div>
                            {% else %}
                                <div class="row">
                                    <div class="col-sm-3">
                                        <label class="form-label">Application Type <font color="red">*</font></label>
                                    </div>
                                    <div class="col-sm-8 justify-content-center">
                                        <label class="custom-control custom-radio">
                                            <input type="radio" name="Application_Type" class="custom-control-input" disabled>
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description">Personal</span>
                                        </label>
                                        <label class="custom-control custom-radio">
                                            <input type="radio" name="Application_Type" class="custom-control-input" checked>
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description">Commercial</span>
                                        </label>
                                    </div>
                                </div>
                            {% endif %}
                            {% if application_details.Application_Type == 'Personal' %}
                            {% if application_details.Nationality_Type == 'Bhutanese' %}
                                <br>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <label class="form-label">Nationality <font color="red">*</font></label>
                                    </div>
                                    <div class="col-sm-8 justify-content-center">
                                        <label class="custom-control custom-radio">
                                            <input type="radio" name="Nationality_Type" class="custom-control-input" checked>
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description">Bhutanese</span>
                                        </label>
                                        <label class="custom-control custom-radio">
                                            <input type="radio" name="Nationality_Type" class="custom-control-input" disabled>
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description">Non-Bhutanese</span>
                                        </label>
                                    </div>
                                </div>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">Applicant CID <font color="red">*</font></label>
                                                <input type="text" class="form-control" value="{{application_details.CID}}" disabled>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">Applicant Name <font color="red">*</font></label>
                                                <input type="text" class="form-control"  value="{{application_details.Applicant_Name}}" disabled>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">Dzongkhag &nbsp;<font color='red'>*</font></label>
                                                <input type="text" class="form-control" value="{{application_details.dzongkhag}}" disabled>
                                            </div>
                                            <div class="alert alert-danger" id="dzongkhagErrorMsg" style="display:none"></div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">Gewog &nbsp;<font color='red'>*</font></label>
                                                <input type="text" class="form-control" value="{{application_details.gewog}}" disabled>
                                            </div>
                                            <div class="alert alert-danger" id="gewogErrorMsg" style="display:none"></div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">Village &nbsp;<font color='red'>*</font></label>
                                                <input type="text" class="form-control" value="{{application_details.village}}" disabled>
                                            </div>
                                            <div class="alert alert-danger" id="villageErrorMsg" style="display:none"></div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">Contact Number <font color="red">*</font></label>
                                                <input type="text" class="form-control" value="{{application_details.Contact_No}}" disabled>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">Email <font color="red">*</font></label>
                                                <input type="email" class="form-control" value="{{application_details.Email}}" disabled>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">Name And Address Supplier <font color="red">*</font></label>
                                                <textarea class="form-control" rows="2" disabled>{{application_details.Email}}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">Country Of Origin <font color="red">*</font></label>
                                                 <select class="form-control" name="Country_Of_Origin"  id="Country_Of_Origin">
                                                    <option value="">--SELECT--</option>
                                                    {% for country in country %}
                                                        <option value="{{ country.Country_Name }}">{{ country.Country_Name }}</option>
                                                    {% endfor %}
                                                 </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">Means of Conveyance <font color="red">*</font></label>
                                                <select class="form-control form-control" disabled>
                                                    {% if application_details.Means_of_Conveyance == 'Air' %}
                                                        <option value="Air" selected>Air</option>
                                                    {% else %}
                                                        <option value="Vehicular" selected>Vehicular</option>
                                                    {% endif %}
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">Place Of Entry <font color="red">*</font></label>
                                                 <select class="form-control" name="entry_point"  id="entry_point">
                                                    <option value="">--SELECT--</option>
                                                    {% for location in location %}
                                                        <option value="{{ location.Field_Office_Id }}">{{ location.Field_Office }}</option>
                                                    {% endfor %}
                                                 </select>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">Purpose <font color="red">*</font></label>
                                                <textarea class="form-control" rows="2" id="B_movementPurpose" name="B_movementPurpose">{{application_details.Purpose}}</textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">Final Destination <font color="red">*</font></label>
                                                <input type="text" class="form-control" id="B_finalDestination" name="B_final_Destination">
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">Expected Arrival Date <font color="red">*</font></label>
                                                <input type="text" class="form-control date-picker flatpickr-input active" id="B_expectedDate" name="date_expected"  placeholder="Pick a date" readonly="readonly">
                                            </div>
                                            <div class="alert alert-danger" id="B_expectedDateErrorMsg" style="display:none"></div>
                                        </div>
                                    </div>
                            {% else %}
                                <div class="row">
                                    <div class="col-sm-3">
                                        <label class="form-label">Nationality <font color="red">*</font></label>
                                    </div>
                                    <div class="col-sm-8 justify-content-center">
                                        <label class="custom-control custom-radio">
                                            <input type="radio" name="Nationality_Type" class="custom-control-input" disabled>
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description">Bhutanese</span>
                                        </label>
                                        <label class="custom-control custom-radio">
                                            <input type="radio" name="Nationality_Type" class="custom-control-input" checked>
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description">Non-Bhutanese</span>
                                        </label>
                                    </div>
                                </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Passport No <font color="red">*</font></label>
                                        <input type="text" class="form-control" value="{{application_details.passport_number}}">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Nationality <font color="red">*</font></label>
                                        <input type="text" class="form-control" value="{{application_details.Nationality}}">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Email <font color="red">*</font></label>
                                        <input type="email" class="form-control" value="{{application_details.Email}}" disabled>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Name <font color="red">*</font></label>
                                        <input type="text" class="form-control" value="{{application_details.Applicant_Name}}" disabled>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Address <font color="red">*</font></label>
                                        <textarea class="form-control" disabled>{{application_details.Applicant_Name}}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Contact Number <font color="red">*</font></label>
                                        <input type="number" class="form-control" value="{{application_details.Contact_No}}" disabled>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Name And Address Supplier <font color="red">*</font></label>
                                        <textarea class="form-control" rows="2" disabled>{{application_details.Name_And_Address_Supplier}}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Country Of Origin <font color="red">*</font></label>
                                         <select class="form-control" name="Origin" id="Origin">
                                            <option value="">--SELECT--</option>
                                            {% for country in country %}
                                                <option value="{{ country.Country_Name }}">{{ country.Country_Name }}</option>
                                            {% endfor %}
                                         </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Means of Conveyance <font color="red">*</font></label>
                                        <select class="form-control form-control" id="p_conveyanceMeans" name="p_conveyanceMeans">
                                            <option value="">-SELECT-</option>
                                            <option value="Air">Air</option>
                                            <option value="Vehicular">Vehicular</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Place Of Entry <font color="red">*</font></label>
                                         <select class="form-control" name="p_entry_point"  id="p_entry_point">
                                            <option value="">--SELECT--</option>
                                            {% for location in location %}
                                                <option value="{{ location.Field_Office_Id }}">{{ location.Field_Office }}</option>
                                            {% endfor %}
                                         </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Purpose <font color="red">*</font></label>
                                        <textarea class="form-control" rows="2" disabled>{{application_details.Purpose}}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Final Destination <font color="red">*</font></label>
                                        <input type="text" class="form-control" value="{{application_details.Final_Destination}}" disabled>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Expected Arrival Date <font color="red">*</font></label>
                                        <input type="text" class="form-control" value="{{application_details.Expected_Arrival_Date}}" disabled>
                                    </div>
                                </div>
                                <div class="col-sm-6 justify-content-center">
                                    <div class="form-group">
                                        <label class="form-label">Products are derived from GMO? <font color="red">*</font></label><br>
                                        <label class="custom-control custom-radio">
                                            <input type="radio" class="custom-control-input" name="GMO" value="Yes" onclick="GMO_Check(this.value)">
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description">Yes</span>
                                        </label>
                                        <label class="custom-control custom-radio">
                                            <input type="radio" class="custom-control-input" name="GMO" value="No" onclick="GMO_Check(this.value)">
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description">No</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            {% endif %}
                            {% else %}
                            <div id="commercial_div" style="display:none;">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">License Number <font color="red">*</font></label>
                                            <input type="text" class="form-control" value="{{application_details.License_No}}" disabled>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Business Name <font color="red">*</font></label>
                                            <input type="text" class="form-control" value="{{application_details.License_No}}" disabled>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Present Address <font color="red">*</font></label>
                                            <textarea class="form-control" rows="2" id="commercial_presentAddress" name="commercial_presentAddress">{{application_details.Present_Address}}</textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Contact Number <font color="red">*</font></label>
                                            <input type="number" class="form-control" value="{{application_details.Contact_No}}" disabled>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Email <font color="red">*</font></label>
                                            <input type="email" class="form-control" value="{{application_details.Email}}" disabled>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Name And Address Supplier <font color="red">*</font></label>
                                            <textarea class="form-control" rows="2" disabled>{{application_details.Name_And_Address_Supplier}}</textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Country Of Origin <font color="red">*</font></label>
                                             <select class="form-control" name="Com_Country_Of_Origin"  id="Com_Country_Of_Origin">
                                                <option value="">--SELECT--</option>
                                                {% for country in country %}
                                                    <option value="{{ country.Country_Name }}">{{ country.Country_Name }}</option>
                                                {% endfor %}
                                             </select>
                                            <div class="alert alert-danger" id="Com_Country_Of_OriginErrorMsg" style="display:none"></div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Means of Conveyance <font color="red">*</font></label>
                                            <select class="form-control form-control" id="com_conveyanceMeans" name="com_conveyanceMeans">
                                                <option value="">-SELECT-</option>
                                                <option value="Air">Air</option>
                                                <option value="Vehicular">Vehicular</option>
                                            </select>
                                        </div>
                                        <div class="alert alert-danger" id="com_conveyanceMeansErrorMsg" style="display:none"></div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Place Of Entry <font color="red">*</font></label>
                                             <select class="form-control" name="com_entry_point"  id="com_entry_point">
                                                <option value="">--SELECT--</option>
                                                {% for location in location %}
                                                    <option value="{{ location.Field_Office_Id }}">{{ location.Field_Office }}</option>
                                                {% endfor %}
                                             </select>
                                        </div>
                                        <div class="alert alert-danger" id="com_entry_pointErrorMsg" style="display:none"></div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Purpose <font color="red">*</font></label>
                                            <textarea class="form-control" rows="2" disabled>{{application_details.Purpose}}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Final Destination <font color="red">*</font></label>
                                            <input type="text" class="form-control" value="{{application_details.Final_Destination}}">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Expected Arrival Date <font color="red">*</font></label>
                                            <input type="text" class="form-control" value="{{application_details.Expected_Arrival_Date}}">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header" role="tab" id="headingTwo">
                <a class="collapsed" data-toggle="collapse" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                    File Attachments
                </a>
            </div>
            <div id="collapseTwo" class="collapse" role="tabpanel" aria-labelledby="headingTwo" data-parent="#accordion" style="">
                <div class="card-body">
                    {% if application_details.Import_Type == 'P' %}
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">File</th>
                                </tr>
                            </thead>
                            <tbody>
                               {% for file_attach in file %}
                                        <tr>
                                            <td>{{ forloop.counter }}</td>
                                            <td><a href='{{file_attach.File_Path}}/{{file_attach.Attachment}}' target="_blank">{{file_attach.Attachment}}</a></td>
                                        </tr>
                                        {% empty %}
                                        <tr>
                                          <td colspan="3" class="text-center">No Data</td>
                                        </tr>
                               {% endfor %}
                            </tbody>
                        </table>
                    {% else %}
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">File</th>
                                </tr>
                            </thead>
                            <tbody>
                               {% for file_attach in file %}
                                        <tr>
                                            <td>{{ forloop.counter }}</td>
                                            <td><a href='{{file_attach.File_Path}}/{{file_attach.Attachment}}' target="_blank">{{file_attach.Attachment}}</a></td>
                                        </tr>
                                        {% empty %}
                                        <tr>
                                          <td colspan="3" class="text-center">No Data</td>
                                        </tr>
                               {% endfor %}
                            </tbody>
                        </table>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header" role="tab" id="headingThree">
                <a class="collapsed" data-toggle="collapse" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                    Inspection Details
                </a>
            </div>
            <div id="collapseThree" class="active" role="tabpanel" aria-labelledby="headingThree" data-parent="#accordion" style="">
                <div class="card-body">
                    {% if application_details.Import_Type == 'P' %}
                        <div id="details-plant">
                            <table id="details-table" class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th scope="col">#</th>
                                        <th scope="col">Import Category</th>
                                        <th scope="col">Crop Common Name</th>
                                        <th scope="col">Crop Variety Name</th>
                                        <th scope="col">Approved Quantity</th>
                                        <th scope="col">Unit</th>
                                        <th scope="col">Quantity Balance</th>
                                        <th scope="col">Quantity Released</th>
                                        <th scope="col">Action</th>

                                    </tr>
                                </thead>
                                <tbody>
                                    {% for import in import %}
                                        <tr>
                                            <td>{{ forloop.counter }}</td>
                                            <td>{{import.Import_Category}}</td>
                                            {% for crop in crop %}
                                                {% if import.Crop_Id == crop.Crop_Id %}
                                                    <td>{{ crop.Crop_Common_Name }}</td>
                                                {% endif %}
                                            {% endfor %}
                                            {% for variety in variety %}
                                                {% if variety.Crop_Variety_Id ==  import.Variety_Id %}
                                                    <td>{{ variety.Crop_Variety_Name}}</td>
                                                {% endif %}
                                            {% endfor %}
                                            <td>{{import.Quantity}}</td>
                                            <td>{{import.Unit}}</td>
                                            <td>{{import.Quantity_Balance}}</td>
                                            <td>{{import.Quantity_Released}}</td>
                                            <td>
                                                <button type="button" class="btn btn-info"
                                                onclick="populateDetails('{{ import.Record_Id }}', '{{import.Import_Category}}', '{{import.Crop_Id}}',
                                                '{{import.Variety_Id}}', '{{import.Quantity}}', '{{import.Unit}}', '{{import.Application_No}}', '{{import.Quantity_Balance}}')">
                                                <i class="zmdi zmdi-edit"></i>
                                                </button>
                                            </td>
                                        </tr>
                                        {% empty %}
                                        <tr>
                                            <td colspan="7" class="text-center">No Data</td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <div id="details-agro">
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th scope="col">#</th>
                                        <th scope="col">Import Category</th>
                                        <th scope="col">Pesticide Name</th>
                                        <th scope="col">Description</th>
                                        <th scope="col">Approved Quantity</th>
                                        <th scope="col">Unit</th>
                                        <th scope="col">Quantity Balance</th>
                                        <th scope="col">Quantity Released</th>
                                        <th scope="col">Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                   {% for import in import %}
                                            <tr>
                                                <td>{{ forloop.counter }}</td>
                                                <td>{{import.Import_Category}}</td>
                                                {% for pesticide in pesticide %}
                                                    {% if pesticide.Pesticide_Id == import.Pesticide_Id %}
                                                    <td>{{import.Pesticide_Name}}</td>
                                                    {% endif %}
                                                {% endfor %}
                                                <td>{{import.Description}}</td>
                                                <td>{{import.Quantity}}</td>
                                                <td>{{import.Unit}}</td>
                                                <td>{{import.Quantity_Balance}}</td>
                                                <td>{{import.Quantity_Released}}</td>
                                                <td>
                                                    <button type="button" class="btn btn-info"
                                                    onclick="populateAgroDetails('{{ import.Record_Id }}', '{{import.Import_Category}}', '{{import.Pesticide_Id}}',
                                                    '{{import.Description}}', '{{import.Quantity}}', '{{import.Unit}}', '{{import.Application_No}}','{{import.Quantity_Balance}}')">
                                                    <i class="zmdi zmdi-edit"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                            {% empty %}
                                            <tr>
                                              <td colspan="6" class="text-center">No Data</td>
                                            </tr>
                                   {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% endif %}
                    <br>
                    <hr>
                    <div class="card-tools">
                        <a href="#" class="btn btn-info btn-border btn-round btn-sm" onclick="openDecisionModal()">
                            <span class="btn-label">
                                <i class="fa fa-print"></i>
                            </span>
                            Add
                        </a>
                    </div>
                    <br>
                    <div id="details">
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">Current Observation</th>
                                    <th scope="col">Decision Conformity Statement</th>
                                   <!-- <th scope="col">Action</th>-->
                                </tr>
                            </thead>
                            <tbody>
                               {% for import in movement_permit %}
                                    <tr>
                                        <td>{{ forloop.counter }}</td>
                                        <td>{{import.Current_Observation}}</td>
                                        <td>{{import.Decision_Conformity}}</td>
                                        <!--<td>
                                            <button type="button"
                                            class="btn btn-primary btn&#45;&#45;icon btn-sm js-edit"
                                            data-url="{% url 'edit_decision' import.Record_Id %}">
                                            <i class="zmdi zmdi-edit"></i>
                                            </button>
                                        </td>-->
                                    </tr>
                                    {% empty %}
                                    <tr>
                                      <td colspan="4" class="text-center">No Data</td>
                                    </tr>
                               {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Inspection Team Leader</label>
                                <select class="form-control" name="teamLeader"  id="teamLeader">
                                    <option value="">--SELECT TEAM LEADER--</option>
                                    {% for inspector_list in inspector_list %}
                                            <option value="{{ inspector_list.Login_Id }}">{{ inspector_list.Name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="alert alert-danger" id="teamLeaderErrorMsg" style="display:none"></div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Inspection Team </label>
                                <textarea class="form-control" id="insTeam" rows="2"></textarea>
                            </div>
                            <div class="alert alert-danger" id="insTeamErrorMsg" style="display:none"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Date Of Inspection</label>
                                <input type="text" class="form-control date-picker flatpickr-input active" id="dateOfInspection" name="date"  placeholder="Pick a date" readonly="readonly">
                            </div>
                            <div class="alert alert-danger" id="dateOfInspectionErrorMsg" style="display:none"></div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Remarks</label>
                                <textarea class="form-control" id="remarks" rows="2"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="alert alert-info" id="success_messageDiv" style="display:none">
                        Application Approved
                    </div>
                    <hr>
                    <div class="card-action text-center">
                        <button type="button" class="btn btn-flat btn-primary" onclick="submit_details('{{application_details.Application_No}}')">
                            <i class="ace-icon fa fa-check"></i>
                            &nbsp;&nbsp;Approve
                        </button>
                        <button type="button" class="btn btn-flat btn-danger">
                            <i class="ace-icon fa fa-times"></i>
                            &nbsp;&nbsp;Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div id="addModal" class="modal" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title"></h5>
                        <button type="button" class="close" onclick="closeModal()">
                            <span aria-hidden="true">&times;</span>
                        </button>

                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Current Observation</label>
                                    <textarea class="form-control" id="currentObservation" rows="2"></textarea>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Decision Conformity Statement </label>
                                    <textarea class="form-control" id="decisionConform" rows="2"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-flat btn-primary" onclick="add_details_ins('{{ application_details.Application_No }}')">
                            <i class="ace-icon fa fa-times"></i>
                            &nbsp;&nbsp;Add
                        </button>
                        <button type="button" class="btn btn-primary" onclick="closeModal()">Close Modal</button>
                     </div>
                     <div id="messageDiv" style="display:none"></div>
                  </div>
            </div>
        </div>

    {% endfor %}
    <div class="modal fade" id="modal-common">
        <div class="modal-dialog modal-lg">
          <div class="modal-content edit">

          </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal-decision">
    <div class="modal-dialog modal-lg">
      <div class="modal-content edit">

      </div>
    </div>
</div>

<form method="post" id="edit_plant_form">
    {% csrf_token %}
    <div class="modal fade" id="add_plant_details" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Edit Details</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="col-lg-12">
                        <div class="box box-primary">
                            <div class="box-body">
                                <input type="text" name="plant_applicationNo" id="plant_applicationNo">
                                <input type="text" name="record_id" id="record_id" style="display:none"/>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Import Category </label>
                                            <select class="form-control form-control" id="plant_import_category" disabled>
                                                <option value="Seed">Seed</option>
                                                <option value="Plant">Plant</option>
                                                <option value="Plant Products">Plant Products</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Crop</label>
                                            <select class="form-control" name="crop_id"  id="crop_id" disabled>
                                                {% for crop in crop %}
                                                        <option value="{{ crop.Crop_Id }}">{{ crop.Crop_Common_Name }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Crop Variety</label>
                                            <select class="form-control" name="crop_variety_id"  id="crop_variety" disabled>
                                                {% for variety in variety %}
                                                        <option value="{{ variety.Crop_Variety_Id }}">{{ variety.Crop_Variety_Name }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-md-6">
                                        <div class="form-group">
                                            <label class="form-label">Quantity</label>
                                            <input type="text" class="form-control" id="qty" name="qty" disabled>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label class="form-label">Unit </label>
                                            <input type="text" class="form-control" name="unit"  id="unit" disabled>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Quantity Balance</label>
                                            <input type="text" class="form-control" id="qty_balance" name="qty_balance" readonly="readonly">
                                        </div>
                                    </div>
                                    <div class="form-group col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Quantity Released</label>
                                            <input type="text" class="form-control" id="qty_approved" name="qty_approved" onchange="balance_plant(this.value)">
                                        </div>
                                        <div class="alert alert-danger" id="certified_qtyErrorMsg" style="display:none"></div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="update_details_plant()">Update</button>
            </div>
            </div>
        </div>
    </div>
</form>
<form method="post" id="edit_agro_form">
    {% csrf_token %}
    <input type="hidden" name="agro_applicationNo" id="agro_applicationNo">
    <div class="modal fade" id="add_agro_details" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                 <div class="modal-header">
                        <h5 class="modal-title">Edit Details</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                        </button>
                </div>
                <div class="modal-body">
                    <div class="col-lg-12">
                        <div class="box box-primary">
                            <div class="box-body">
                                <input type="text" name="agro_record_id" id="agro_record_id" style="display:none"/>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Import Category </label>
                                            <select class="form-control form-control" id="agro_category" disabled>
                                                <option value="">-SELECT-</option>
                                                <option value="Seed">Pesticides</option>
                                                <option value="Plant">Bio-Pesticides</option>
                                                <option value="Plant Products">Plant Products</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Pesticide</label>
                                            <select class="form-control" name="pesticide_id"  id="pesticide_id" disabled>
                                                {% for pesticide in pesticide %}
                                                        <option value="{{ pesticide.Pesticide_Id }}">{{ pesticide.Pesticide_Name }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Description</label>
                                            <textarea class="form-control" rows="3" id="description" name="description" disabled></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Quantity</label>
                                            <input type="text" class="form-control" id="agro_qty" disabled>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-label">Unit </label>
                                            <input type="text" class="form-control" name="agro_unit"  id="agro_unit" disabled>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label class="form-label">Quantity Balance</label>
                                            <input type="text" class="form-control" id="agro_qty_balance" name="agro_qty_balance" readonly="readonly">
                                        </div>
                                    </div>
                                    <div class="form-group col-md-6">
                                        <div class="form-group">
                                            <label class="form-label">Quantity Released</label>
                                            <input type="text" class="form-control" id="agro_qty_approved" name="agro_qty_approved" onchange="balance_agro(this.value)">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="update_details_agro()">Add</button>
                </div>
            </div>
        </div>
    </div>
</form>
<script src="{% static 'assets/js/app.min.js' %}"></script>
<script>
$(function(){
    var today = new Date().toISOString().split('T')[0];
    $('#dateOfInspection')[0].setAttribute('min', today);
});
function openDecisionModal()
{
    $('#addModal').modal('show');
}

function closeModal()
{
    $("#addModal").modal('hide');
}

function add_details_ins(application_id)
{
    currentObservation = $('#currentObservation').val();
    decisionConform = $('#decisionConform').val();

    $.ajax({
        type : "GET",
        url : "{% url 'add_details_ins_import' %}",
        data :{'application_id':application_id,'currentObservation':currentObservation,'decisionConform':decisionConform},
        success : function(data) {
            $('#details').html(data);
            $('#details').show();
            $('#addModal').modal('hide');
        }
    });
}

function submit_details(application_id)
{

    Inspection_Leader = $('#teamLeader').val();
    Inspection_Team = $('#insTeam').val();
    remarks = $('#remarks').val();
    dateOfInspection = $('#dateOfInspection').val();

    if(Inspection_Leader == "")
    {
        $('#teamLeaderErrorMsg').html("Select Team Leader.");
        $('#teamLeaderErrorMsg').show();
        $('#teamLeaderErrorMsg').delay(2000).fadeOut('slow');
        $('#teamLeader').focus();
    }
    else if(Inspection_Team == "")
    {
        $('#insTeamErrorMsg').html("Enter Inspection Team.");
        $('#insTeamErrorMsg').show();
        $('#insTeamErrorMsg').delay(2000).fadeOut('slow');
        $('#insTeam').focus();
    }
    else if(dateOfInspection == "")
    {
        $('#dateOfInspectionErrorMsg').html("Select Date Of Inspection.");
        $('#dateOfInspectionErrorMsg').show();
        $('#dateOfInspectionErrorMsg').delay(2000).fadeOut('slow');
        $('#dateOfInspection').focus();
    }
    else
    {
        $.ajax({
            type : "GET",
            url : "{% url 'submit_application' %}",
            data :{'application_no':application_id , 'Inspection_Leader':Inspection_Leader ,'Inspection_Team':Inspection_Team ,'remarks':remarks , 'dateOfInspection':dateOfInspection},
            success : function(data) {
                $('#success_messageDiv').show();
                setTimeout(function() {
                    $("#success_messageDiv").hide('blind', {}, 500)
                }, 2000);
                setTimeout(function() {
                    $('#application-details-modal').modal('hide');
                }, 3000);
                setTimeout(function() {
                    window.location.href = '{% url 'dashboard' %}';
                }, 3000);
            }
        });
    }
}

function populateDetails(Record_Id, Import_Category, Crop_Id, Variety_Id, Quantity, Unit, application_no, quantity_balance)
{
    $('#record_id').val(Record_Id);
    $('#plant_import_category').val(Import_Category);
    $('#crop_id').val(Crop_Id);
    $('#crop_variety').val(Variety_Id);
    $('#qty').val(Quantity);
    $('#unit').val(Unit);
    $('#plant_applicationNo').val(application_no);
    $('#qty_balance').val(quantity_balance);
    $('#add_plant_details').modal('show');
}

function populateAgroDetails(Record_Id, Import_Category, Pesticide_Id, Description, Quantity, Unit, application_no, balance_quantity)
{

    $('#agro_record_id').val(Record_Id);
    $('#agro_category').val(Import_Category);
    $('#pesticide_id').val(Pesticide_Id);
    $('#description').val(Description);
    $('#agro_qty').val(Quantity);
    $('#agro_unit').val(Unit);
    $('#agro_applicationNo').val(application_no);
    $('#agro_qty_balance').val(balance_quantity);
    $('#add_agro_details').modal('show');
}

function update_details_plant()
{
    $.ajax({
        type : "POST",
        url : "{% url 'update_details_plant' %}",
        data : $('#edit_plant_form').serialize(),
        success : function(response) {
             $('#details-plant').html(response);
             $('#add_plant_details').modal('hide');
             $('.modal-backdrop').remove();
        }
    });
}

function update_details_agro()
{
    $.ajax({
        type : "POST",
        url : "{% url 'update_details_agro' %}",
        data : $('#edit_agro_form').serialize(),
        success : function(response) {
            $('#details-agro').html(response);
            $('#add_agro_details').modal('hide');
            $('.modal-backdrop').remove();
        }
    });
}

function balance_plant(approved_qty)
{
    var qty_balance = $('#qty_balance').val();
    if(approved_qty > qty_balance)
    {
        $('#certified_qtyErrorMsg').html("quantity certified cannot be more than quantity requested.");
        $('#certified_qtyErrorMsg').show();
        $('#certified_qtyErrorMsg').delay(2000).fadeOut('slow');
        $('#qty_approved').val("");
    }
}

function balance_agro(approved_qty)
{
    var qty = $('#agro_qty_balance').val();
    var balance = qty - approved_qty
    $('#agro_qty_balance').val(balance);
}
</script>